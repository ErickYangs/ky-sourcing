<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta http-equiv="X-UA-Compatible" content="IE=10"/>
  <title>本体存证</title>
  <link rel="stylesheet" type="text/css" href="static/css/bootstrap.min.css"/>
  <!-- <link rel="stylesheet" type="text/css" href="static/css/code.css"/> -->
  <!-- <link href="static/js/js_20171020/flatpickr.css" rel="stylesheet"> -->
  <!-- <link rel="stylesheet" type="text/css" href="static/css/font-awesome.min.css"/> -->
  <!--[if lt IE 9]>
  <script src="static/js/html5shiv.js"></script>
  <script src="static/js/respond.min.js"></script>
  <![endif]-->
  <!-- <script type="text/javascript" src="static/js/jquery.min.js"></script>
  <script type="text/javascript" src="static/js/bootstrap.min.js"></script>
  <script src="static/js/js_20171020/sockjs.js"></script>
  <script src="static/js/js_20171020/stomp.js"></script>
  <script src="static/js/js_20171020/flatpickr.js"></script> -->
  <!--<script src="http://cdn.hcharts.cn/highcharts/highcharts.js"></script>-->
  <style>
    html {
      font-size: 12px;
      height: 100%;
    }

    body {
      font-family: "PingFangSC-Regular", "PingHei", "Lucida Grande", "Lucida Sans Unicode", "STHeitiSC-Light", Helvetica, "BBAlpha Sans", "S60 Sans", "Hiragino Sans GB", Arial, "Microsoft YaHei", "Verdana", SimHei, STXihei, SimSun, "WenQuanYi Micro Hei", sans-serif;
      overflow-x: hidden;
      height: 100%;
      font-size: 12px;
      background: #f7f8f8;
    }
    /* html {

font-size: 20px;

}

@media only screen and (min-width: 400px) {

  html {font-size: 21.33333333px !important;}
}

@media only screen and (min-width: 414px) {

  html {font-size: 22.08px !important;}

}

@media only screen and (min-width: 480px) {

  html {font-size: 25.6px !important;}

}

html {

font-family: sans-serif;

-ms-text-size-adjust: 100%;

-webkit-text-size-adjust: 100%;

} */
  </style>


  <!-- start -->
  <!--<link href="https://cdn.bootcss.com/dropzone/5.1.1/min/basic.min.css" rel="stylesheet">-->
  <!--<link href="https://cdn.bootcss.com/dropzone/5.1.1/min/dropzone.min.css" rel="stylesheet">-->
  <!--<script src="https://cdn.bootcss.com/dropzone/5.1.1/dropzone.js"></script>-->
  <!-- <script src="static/js/js_20170907/dropzone_dist/dropzone.js"></script>
  <link rel="stylesheet" href="static/js/js_20170907/dropzone_dist/dropzone.css"> -->

  <!--<script src="https://cdn.bootcss.com/crypto-js/3.1.9/core.min.js"></script>-->
  <!--<script src="https://cdn.bootcss.com/crypto-js/3.1.9/crypto-js.min.js"></script>-->
  <!--<script src="https://cdn.bootcss.com/crypto-js/3.1.9/sha256.min.js"></script>-->

  <!-- <script src="static/js/js_20170907/plugins.js"></script>
  <script src="static/js/js_20170907/angular.min.js"></script>

  <script src="static/js/js_20170907/CryptoJS/rollups/sha256.js"></script>
  <script src="static/js/js_20170907/CryptoJS/rollups/ripemd160.js"></script>
  <script src="static/js/js_20170907/CryptoJS/rollups/aes.js"></script>
  <script src="static/js/js_20170907/CryptoJS/components/pad-nopadding.js"></script>

  <script src="static/js/js_20170907/sm.js"></script>
  <script src="static/js/js_20170907/ecdsa/lib/bundle.js"></script>
  <script src="static/js/js_20170907/secp256k1/bundle.js"></script>

  <script src="static/js/js_20170907/app.js"></script>
  <script src="static/js/js_20170907/wallet.js"></script> -->

  <style>
    /* hash calc */
    #drop_target {

      width: 80%;
      height: 200px;
      background: #ccc;
      /*border: 1px solid #999;*/
      text-align: center;
      /*line-height: 200px;*/

      border: 2px solid #e5e5e5;
      font-family: Roboto, sans-serif;
      color: #777;
      -webkit-transition: background-color .2s linear;
      transition: background-color .2s linear;

      margin: 8px auto;

      display: none;
    }
  </style>

  <!-- end -->


</head>


<body>
<div id="app"></div>

<!--<div style="margin-top: 24px;">-->

<!--&lt;!&ndash; Change /upload-target to your upload address &ndash;&gt;-->
<!--<form id="my-awesome-dropzone" action="/upload-target" class="dropzone"></form>-->

<!--</div>-->

</body>


<!-- start -->
<script>

  window.onload = function () {


    //
//    $('#result_table').hide();

//    //
//    function ab2hs(arr) {
//      var result = "";
//      for (i = 0; i < arr.length; i++) {
//        var str = arr[i].toString(16);
//        str = str.length == 0 ? "00" :
//          str.length == 1 ? "0" + str :
//            str;
//        result += str;
//      }
//      return result;
//    }
//
//    //
//    function dragHandle(event) {
//
//      //
//      event.preventDefault();
//
//      //
//      var info = "",
//        outputEle = document.getElementById("drop_target"),
//        files, i, len;
//
//      //
//      if (event.type == "drop" || event.type == "change") {
//
//        if (event.type == "drop")
//          files = event.dataTransfer.files;
//
//        if (event.type == "change")
//          files = event.target.files;
//
//        info += files[0].name + "( " + files[0].type + ", " + files[0].size + " bytes) <br>";
//
//
//        // TODO 进度条
//
//        var reader = new FileReader();
//
//        reader.onload = function () {
//
//          var data = new Uint8Array(this.result);
//          var dataHexString = ab2hs(data);
//
//          //
//          var hash_result = Wallet.Sha256(dataHexString);
//
//          //
//          console.log(hash_result);
//
//          // 细节处理
//          $("#id_hash").removeAttr('placeholder');
//          $("#id_hash").val(hash_result);
//
//          // 查询
//          $.ajax({
////            url: 'http://42.159.233.39/fl/transaction/service/getTransactionByFileHash/' + hash_result,
//            url: 'http://42.159.196.7/fl/transaction/service/getTransactionByFileHash/' + hash_result,
//            cache: false,
//            beforeSend: function () {
//
//            },
//            complete: function (data) {
//
//            },
//            success: function (data) {
//
//              //
//              $('#result_table').show();
//              $('#id_list_content').hide();
//
//              //
//              console.log(data);
//              console.log(data[0]);
//
//              //
//              result_json = data[0];
//
//              //
//              $('#cz_main_part').show();
//
//              //
//              var res, isvoid = function (x) {
//                return typeof x === "undefined" || x === null;
//              }
//
//              // 设置数据
//              if (!isvoid(result_json) && result_json['total'] == 1) {  // TODO
//                document.getElementById('cz_total').innerHTML = '1';
//                document.getElementById('txid').innerHTML = result_json['txid'];
//                document.getElementById('address').innerHTML = result_json['address'];
//                document.getElementById('block_height').innerHTML = result_json['block_height'];
//                document.getElementById('block_timestamp').innerHTML = result_json['block_timestamp'];
//                document.getElementById('filehash').innerHTML = result_json['filehash'];
//                document.getElementById('hash_alg').innerHTML = result_json['hash_alg'];
//                document.getElementById('datastr').innerHTML = result_json['datastr'];
//
//                // 成功后，修改地址栏
//                window.history.pushState({}, 0, 'http://' + window.location.host + '/#/detail/' + result_json['txid']);
//
//              } else {
//
//                //
//                document.getElementById('cz_total').innerHTML = '0';
//                $('#cz_main_part').hide();
//
//                // 失败后，修改地址栏
//                window.history.pushState({}, 0, 'http://' + window.location.host + '/');
//
//              }
//            },
//            error: function (data) {
//
//              //
//              $('#result_table').hide();
//              $('#id_list_content').show();
//
//              //
//              alert('请重试！');
//
//            }
//
//          });
//
//          //
//          dataHexString = null;
//        };
//
//        //
//        reader.readAsArrayBuffer(files[0]);
//      }
//    }
//
//    //
//    document.getElementById("id_top_content").addEventListener("dragenter", dragHandle, false);
//    document.getElementById("id_top_content").addEventListener("dragover", dragHandle, false);
//    document.getElementById("id_top_content").addEventListener("drop", dragHandle, false);
//
//    //
//    document.getElementById("actual-file-upload").addEventListener("change", dragHandle, false);


    /*
    // 根据id查询
    document.getElementById("id_search_id_button").addEventListener("click", search_id_handler, false);

    function search_id_handler() {

      // 获取id
      var id = $(this).closest("div").find("input[name='input_value']").val();

      // 细节处理
      $("#id_hash").removeAttr('placeholder');
      $("#id_hash").val(id);

      // 查询
      $.ajax({
//        url: 'http://42.159.233.39/fl/transaction/service/getTransactionByid/' + id,
        url: 'http://42.159.196.7/fl/transaction/service/getTransactionByid/' + id,
        cache: false,
        beforeSend: function () {

        },
        complete: function (data) {

        },
        success: function (data) {

          //
          $('#result_table').show();
          $('#id_list_content').hide();

          //
          console.log(data);
          console.log(data[0]);

          //
          result_json = data[0];

          //
          $('#cz_main_part').show();

          //
          var res, isvoid = function (x) {
            return typeof x === "undefined" || x === null;
          }

          // 设置数据  // TODO
          if (!isvoid(result_json) && result_json['total'] == 1) {
            document.getElementById('cz_total').innerHTML = '1';
            document.getElementById('txid').innerHTML = result_json['txid'];
            document.getElementById('address').innerHTML = result_json['address'];
            document.getElementById('block_height').innerHTML = result_json['block_height'];
            document.getElementById('block_timestamp').innerHTML = result_json['block_timestamp'];
            document.getElementById('filehash').innerHTML = result_json['filehash'];
            document.getElementById('hash_alg').innerHTML = result_json['hash_alg'];
            document.getElementById('datastr').innerHTML = result_json['datastr'];

            //
            window.history.pushState({}, 0, 'http://' + window.location.host + '/#/detail/' + result_json['txid']);

          } else {

            //
            document.getElementById('cz_total').innerHTML = '0';
            $('#cz_main_part').hide();

            //
            window.history.pushState({}, 0, 'http://' + window.location.host + '/');

          }

        },
        error: function (data) {

          //
          $('#result_table').hide();
          $('#id_list_content').show();

          //
          alert('请重试！');

        }

      });
    }
    */

    //
    function handleFileSelect(evt) {

      var files = evt.target.files; // FileList object

      // use the 1st file from the list
      f = files[0];

      var reader = new FileReader();

      // Closure to capture the file information.
      reader.onload = (function (theFile) {
        return function (e) {

          jQuery('#ms_word_filtered_html').val(e.target.result);
        };
      })(f);

      // Read in the image file as a data URL.
      reader.readAsText(f);

      //
      var hash_result = Wallet.Sha256(dataHexString);

      alert(hash_result);
    }
  }

</script>
<!-- end -->


</html>
